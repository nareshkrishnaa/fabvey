(window.mutinyWpJsonp=window.mutinyWpJsonp||[]).push([[8],{42:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Ready="ready",e.EmailCaptured="emailCapture",e.PhoneCaptured="phoneCapture",e.MeetingBooked="scheduling:meetingBooked"}(r||(r={}))},52:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(42),o=n(10),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const s=e=>!!(null==e?void 0:e.on);const a=()=>i(void 0,void 0,void 0,(function*(){if(s(window.drift))return window.drift;const e=yield Object(o.b)(window,"drift");return yield Object(o.b)(e,"on"),function(e){if(!s(e))throw new Error("Expected the Drift client to be initialized but it is not")}(window.drift),window.drift})),c=()=>i(void 0,void 0,void 0,(function*(){const e=yield a();return new Promise(t=>{e.on(r.a.Ready,e=>{t(e)})})}))},91:function(e,t,n){"use strict";n.r(t),n.d(t,"attachEvents",(function(){return P}));var r=n(2),o=n(3),i=n(55),s=n(0);var a=class{constructor(e,t){this.record=e,this.exporter=t,this.attached=!1,this.logger=new r.a("dom-event")}setup(){!this.attached&&this.shouldAttach()&&(this.attach(),this.attached=!0)}teardown(){if(this.logger.info("Attempting to tear down DomEvent",this.record),this.detach())return this.logger.info(`Removed ${this.record.listener_type} event listener from ${this.record.selector}`),void(this.attached=!1);this.logger.debug("Could not detach DOM event "+this.record)}isAttached(){return this.attached}};var c=class extends a{constructor(e,t,n){super(e,t),this.record=e,this.exporter=t,this.logger=new r.a("dom-event"),this.element=n||(e.selector?document.querySelector(e.selector):null)}attach(){var e;const t=this.listenerType();this.shouldAttach()&&!this.attached&&(null===(e=this.getElement())||void 0===e||e.addEventListener(t,this.listener.bind(this)),this.attached=!0)}shouldAttach(){return!!this.getElement()||(this.logger.info("Attempted to attach listener but could not find target element",this.record),!1)}listenerType(){return this.record.listener_type}detach(){return this.element?(this.element.removeEventListener(this.record.listener_type,this.listener),!0):(this.logger.error("No element to remove listener from",this.record,this.element),!1)}getElement(){return this.isOriginalRendered()?this.element:this.record.selector?(this.element=document.querySelector(this.record.selector),this.element):void 0}isOriginalRendered(){return!!this.element&&(!(this.element instanceof HTMLElement)||document.contains(this.element))}},d=n(33);var u=class extends c{constructor(e,t,n){super(e,t,n),this.record=e}listener(e){const{conversion_configuration_id:t}=this.record;this.exporter.track(d.a.Conversion,{conversionConfigurationId:t,formData:{}})}};var h=class extends c{constructor(e,t,n,r){super(e,t,r),this.record=e,this.userData=n}listener(e){const{value:t}=e.target;this.userData.set(this.record.data.store_key,t)}shouldAttach(){return!0}};const l=e=>e.data.event&&"calendly.event_scheduled"===e.data.event;var f=class extends u{constructor(e,t){super(e,t,window),this.record=e}listener(e){e instanceof MessageEvent&&l(e)&&super.listener(e)}listenerType(){return"message"}},v=n(42),m=n(52),p=n(44),g=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};const w=e=>g(void 0,void 0,void 0,(function*(){const t=yield Object(m.a)();t.on(v.a.EmailCaptured,Object(p.a)(e,v.a.EmailCaptured)),t.on(v.a.PhoneCaptured,Object(p.a)(e,v.a.PhoneCaptured)),t.on(v.a.MeetingBooked,Object(p.a)(e,v.a.MeetingBooked))})),b=e=>w((e=>(t,n)=>{switch(t){case v.a.EmailCaptured:e.track(d.a.Conversion,{formData:Object.assign(Object.assign({},n),{name:"[Drift] Email Captured"})});break;case v.a.PhoneCaptured:e.track(d.a.Conversion,{formData:Object.assign(Object.assign({},n),{name:"[Drift] Phone Captured"})});break;case v.a.MeetingBooked:e.track(d.a.Conversion,{formData:Object.assign(Object.assign({},n),{name:"[Drift] Meeting Booked"})})}})(e));class y extends a{constructor(e,t){super(e,t),this.record=e}attach(){w(this.listener.bind(this))}shouldAttach(){return!0}detach(){return!0}listener(e,t){this.attached&&this.exporter.track(d.a.Conversion,{conversionConfigurationId:this.record.conversion_configuration_id,formData:t})}isOriginalRendered(){return!0}}function k(e){return"hsFormCallback"===e.data.type&&"onFormSubmit"===e.data.eventName}class C extends u{constructor(e,t){super(e,t,window),this.record=e}listener(e){e instanceof MessageEvent&&k(e)&&super.listener(e)}listenerType(){return"message"}}var O=n(50),x=n(64);var _=class extends u{listener(e){const{conversion_configuration_id:t}=this.record,{target:n}=e;if(n&&n instanceof HTMLAnchorElement&&"_blank"!==n.target&&!Object(o.f)(Object(o.g)(n.href),window.location)){const{href:r}=n;Object(O.c)(e,()=>(this.exporter.track(d.a.Conversion,{conversionConfigurationId:t,formData:{}}),this.exporter.forceFlushQueues()),()=>Object(x.a)(r),5e3)}else super.listener(e)}};var D=class extends a{constructor(e,t){super(e,t),this.record=e}attach(){const{conversion_configuration_id:e}=this.record;this.exporter.track(d.a.Conversion,{conversionConfigurationId:e,formData:{}})}shouldAttach(){return Object(o.f)(this.record,window.location)}detach(){return!0}isOriginalRendered(){return!0}};var E=(e,t,n)=>{if(e.event_type===s.h.Data)return new h(e,n,t);if((e=>e.event_type===s.h.Conversion)(e)){const{listener_type:t}=e;switch(t){case s.o.PageView:return new D(e,n);case s.o.Click:return new _(e,n);case s.o.Calendly:return new f(e,n);case s.o.Drift:return new y(e,n);case s.o.Hubspot:return new C(e,n);default:return new u(e,n)}}throw new Error(`Unknown DOMUpdate type '${e}'`)},j=n(35),A=n(6);function M(e,t,n,r){const{tracked_domains:i}=e;return!!i&&Object(A.b)(i,e=>{const{_mv:i}=Object(o.h)(n);return t.includes(e)&&!window.location.href.includes(e)&&i!==r})}const P=(e,t)=>{const n=new r.a("entry"),s=Object(o.c)(e.dom_events,t.preview);var a;s.length>0?n.info("DOM Events:",s):n.info("No DOM Events to attach"),e.config.track_calendly&&(a=t.exporter,window.addEventListener("message",e=>{if(l(e)){const{hostname:e,pathname:t}=window.location;a.track(d.a.Conversion,{formData:{name:`[Calendly] Meeting Booked (${e}${t})`}})}})),e.config.track_drift&&b(t.exporter),e.config.track_hubspot&&function(e){window.addEventListener("message",t=>{k(t)&&e.track(d.a.Conversion,{formData:{name:"[HubSpot] Form Submitted"}})})}(t.exporter);const c=new i.a(!1,[],s.map(e=>E(e,t.userDataStore.getWriteableStore(),t.exporter)),"event-renderer");c.onRender(()=>function(e,t){const n=new r.a("cross-domain-tracker"),{tracked_domains:i}=e.config;n.info("Checking to attach for",i),i&&(n.info("Queuing timeout",i),setTimeout(()=>{n.info("Attaching cross domain tracker");for(const r of Array.prototype.slice.call(document.querySelectorAll("a")))M(e.config,r.href,r.search,t)&&(n.info("Adding param to",r),r.href=Object(o.a)(r.href,j.i,t))},0))}(e,t.visitorToken)),c.renderAsync()}}}]);